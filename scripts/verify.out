## SLURM PROLOG ###############################################################
##    Job ID : 11325074
##  Job Name : run_train_test.sh
##  Nodelist : gpu2007
##      CPUs : 
##  Mem/Node : 65536 MB
## Directory : /gpfs_home/xcao1/UDML-SS/scripts
##   Started : Fri Mar 27 17:46:52 EDT 2020
###############################################################################
module: loading 'gcc/7.2'
module: gcc: "Note: loading the gcc module overrides the gcc version on the system.  If you want to revert to the version of gcc provided by the OS, unload the gcc module."
module: loading 'anaconda/3-5.2.0'
module: loading 'cuda/10.0.130'
module: loading 'cudnn/7.4'
module: cudnn: To use: module load cuda/10.0.130
Begin Training!
25396838400
Namespace(alpha=40, batch_size=80, beta=2.0, corruption=0, data='cub', data_root='/gpfs/data/xl6/xuefei/ML/data', dim=512, epochs=600, freeze_BN=True, gallery_eq_query=True, init='random', k=16, loss='Weight', loss_base=0.75, lr=1e-05, margin=0.5, momentum=0.9, nThreads=16, net='Inception', num_clusters=100, num_instances=5, origin_width=256, orth_reg=0, pool_feature=False, pretrained=True, print_freq=20, ratio=0.16, resume='yes', rot_batch=16, rot_bt=1, rot_lr=5e-06, rot_only=0.0, save_dir='/gpfs/data/xl6/xuefei/ML/results/Deep_Metric/ckpt/Weight/cub/Inception-DIM-512-lr-0.00001-ratio-0.16-BatchSize-80-rot_lr-0.000005-self_supervision_rot-0.1-rot_bt-1-rot_batch-16-up_step-5-num_clusters-100-ALPHA-40-BETA-2', save_step=50, self_supervision_rot=0.1, up_step=5, use_test=0.0, weight_decay=0.0005, width=227)
Learn Rate  	1.0e-05
Epochs  	00600
Log Path 	/gpfs/data/xl6/xuefei/ML/results/Deep_Metric/ckpt/Weight/cub/Inception-DIM-512-lr-0.00001-ratio-0.16-BatchSize-80-rot_lr-0.000005-self_supervision_rot-0.1-rot_bt-1-rot_batch-16-up_step-5-num_clusters-100-ALPHA-40-BETA-2
Network 	 Inception
Data Set 	 cub
Batch Size  	 80
Num-Instance  	 5
Embedded Dimension 	 512
Loss Function 	Weight
Alpha 	 40
Begin to fine tune Inception Network
########################################
Sequential(
  (0): Linear(in_features=1024, out_features=512, bias=True)
  (1): ReLU(inplace=True)
  (2): Linear(in_features=512, out_features=4, bias=True)
  (3): ReLU(inplace=True)
)
loaded++++++++++++++++++++++++++++++++++
dict_keys(['inception_3a.3x3_reduce.bias', 'inception_4e.1x1.bias', 'inception_4b.1x1.bias', 'inception_4a.pool_proj.weight', 'inception_4d.1x1.weight', 'inception_3b.pool_proj.bias', 'inception_4e.1x1.weight', 'inception_4d.5x5_reduce.weight', 'inception_4b.pool_proj.weight', 'inception_3a.3x3.bias', 'inception_4b.3x3.bias', 'inception_3b.5x5_reduce.weight', 'inception_4a.1x1.bias', 'inception_3b.1x1.weight', 'inception_5b.5x5_reduce.weight', 'inception_4e.5x5.bias', 'inception_4d.1x1.bias', 'inception_4d.5x5.bias', 'inception_3b.3x3_reduce.weight', 'inception_5b.3x3.bias', 'inception_3a.pool_proj.weight', 'inception_4c.5x5_reduce.bias', 'inception_3b.3x3.bias', 'inception_5a.3x3_reduce.weight', 'inception_4e.pool_proj.weight', 'inception_4a.1x1.weight', 'inception_4e.3x3.weight', 'inception_5b.3x3_reduce.bias', 'inception_4a.5x5_reduce.weight', 'inception_4a.5x5_reduce.bias', 'inception_5a.3x3.weight', 'inception_4c.3x3.weight', 'inception_4e.5x5_reduce.bias', 'inception_4c.5x5.weight', 'inception_4a.3x3.bias', 'inception_4c.pool_proj.bias', 'inception_4d.3x3.bias', 'conv1.7x7_s2.bias', 'inception_4b.1x1.weight', 'inception_4a.pool_proj.bias', 'inception_4b.3x3_reduce.weight', 'inception_5b.5x5.bias', 'inception_3a.5x5_reduce.bias', 'inception_5a.1x1.bias', 'inception_4d.pool_proj.bias', 'conv2.3x3_reduce.bias', 'inception_4a.3x3.weight', 'inception_4d.3x3_reduce.weight', 'inception_5a.5x5_reduce.weight', 'inception_3b.5x5_reduce.bias', 'inception_4b.3x3_reduce.bias', 'inception_3a.3x3.weight', 'inception_4c.3x3_reduce.bias', 'inception_5a.3x3.bias', 'inception_4d.3x3.weight', 'inception_5b.1x1.bias', 'inception_4a.5x5.weight', 'inception_3b.3x3_reduce.bias', 'inception_4a.3x3_reduce.weight', 'inception_3a.1x1.weight', 'inception_5a.5x5_reduce.bias', 'inception_4d.pool_proj.weight', 'inception_3b.1x1.bias', 'inception_4b.5x5_reduce.weight', 'inception_3b.3x3.weight', 'inception_4c.3x3_reduce.weight', 'inception_5b.1x1.weight', 'inception_5b.5x5_reduce.bias', 'inception_4c.5x5_reduce.weight', 'inception_5b.5x5.weight', 'inception_5a.5x5.bias', 'conv1.7x7_s2.weight', 'inception_3b.5x5.weight', 'inception_3a.1x1.bias', 'inception_4c.pool_proj.weight', 'inception_4e.3x3_reduce.weight', 'inception_5a.1x1.weight', 'inception_4c.1x1.weight', 'inception_5b.pool_proj.bias', 'inception_4e.5x5.weight', 'inception_4d.5x5_reduce.bias', 'inception_4b.5x5_reduce.bias', 'inception_4e.3x3.bias', 'inception_5a.pool_proj.bias', 'inception_3b.5x5.bias', 'inception_4b.5x5.bias', 'inception_4e.3x3_reduce.bias', 'inception_4e.pool_proj.bias', 'inception_5b.3x3.weight', 'conv2.3x3.bias', 'inception_5b.3x3_reduce.weight', 'inception_3a.5x5.bias', 'inception_5a.3x3_reduce.bias', 'inception_3a.pool_proj.bias', 'inception_5a.5x5.weight', 'inception_4d.3x3_reduce.bias', 'inception_4c.5x5.bias', 'inception_4b.pool_proj.bias', 'inception_4b.3x3.weight', 'inception_3a.3x3_reduce.weight', 'inception_4c.3x3.bias', 'conv2.3x3_reduce.weight', 'inception_4e.5x5_reduce.weight', 'inception_5b.pool_proj.weight', 'inception_3a.5x5_reduce.weight', 'inception_4c.1x1.bias', 'inception_3b.pool_proj.weight', 'inception_4a.3x3_reduce.bias', 'inception_5a.pool_proj.weight', 'inception_4b.5x5.weight', 'inception_3a.5x5.weight', 'conv2.3x3.weight', 'inception_4a.5x5.bias', 'inception_4d.5x5.weight'])
114
finished
width: 	 227
bgr init
train.txt is used!
transform used: Compose(
    <data.transforms.CovertBGR object at 0x7ff4b4da7d68>
    Resize(size=256, interpolation=PIL.Image.BILINEAR)
    RandomResizedCrop(size=(227, 227), scale=(0.16, 1), ratio=(0.75, 1.3333), interpolation=PIL.Image.BILINEAR)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.40784313725490196, 0.4588235294117647, 0.5019607843137255], std=[0.00392156862745098, 0.00392156862745098, 0.00392156862745098])
)
transform used: Compose(
    <data.transforms.CovertBGR object at 0x7ff4b4da7d68>
    Resize(size=256, interpolation=PIL.Image.BILINEAR)
    CenterCrop(size=(227, 227))
    ToTensor()
    Normalize(mean=[0.40784313725490196, 0.4588235294117647, 0.5019607843137255], std=[0.00392156862745098, 0.00392156862745098, 0.00392156862745098])
)
/users/xcao1/anaconda/my_env_1.2/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Extract Features: [59/59]	Time 0.021 (0.021)	Data 51.338 (51.338)	
torch.Size([5864, 1024]) <class 'torch.Tensor'>
finish cluster
label 0 100
0.1612291255850956 (100, 1024)
width: 	 227
bgr init
train.txt is used!
transform used: Compose(
    <data.transforms.CovertBGR object at 0x7ff4ade76208>
    Resize(size=256, interpolation=PIL.Image.BILINEAR)
    RandomResizedCrop(size=(227, 227), scale=(0.16, 1), ratio=(0.75, 1.3333), interpolation=PIL.Image.BILINEAR)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.40784313725490196, 0.4588235294117647, 0.5019607843137255], std=[0.00392156862745098, 0.00392156862745098, 0.00392156862745098])
)
transform used: Compose(
    <data.transforms.CovertBGR object at 0x7ff4ade76208>
    Resize(size=256, interpolation=PIL.Image.BILINEAR)
    CenterCrop(size=(227, 227))
    ToTensor()
    Normalize(mean=[0.40784313725490196, 0.4588235294117647, 0.5019607843137255], std=[0.00392156862745098, 0.00392156862745098, 0.00392156862745098])
)
Extract Features: [60/60]	Time 0.019 (0.019)	Data 57.927 (57.927)	
feature normalized
tensor(92839.5469) test
100 num_clusters
K-means done
[0.47045915 0.59908845 0.72451047 0.82714382 0.90074274 0.95087779] 0.5532238052960019
Epoch-0 0.4705  0.5991  0.7245  0.8271  0.9007  0.9509  0.5532
######################################## 
 BatchNorm frozen
{140688983087072, 140688983087144, 140688983087216, 140688983087288}
initial model is save at /gpfs/data/xl6/xuefei/ML/results/Deep_Metric/ckpt/Weight/cub/Inception-DIM-512-lr-0.00001-ratio-0.16-BatchSize-80-rot_lr-0.000005-self_supervision_rot-0.1-rot_bt-1-rot_batch-16-up_step-5-num_clusters-100-ALPHA-40-BETA-2
width: 	 227
bgr init
train_1.txt is used!
transform used: Compose(
    <data.transforms.CovertBGR object at 0x7ff4ae1d19b0>
    Resize(size=256, interpolation=PIL.Image.BILINEAR)
    RandomResizedCrop(size=(227, 227), scale=(0.16, 1), ratio=(0.75, 1.3333), interpolation=PIL.Image.BILINEAR)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.40784313725490196, 0.4588235294117647, 0.5019607843137255], std=[0.00392156862745098, 0.00392156862745098, 0.00392156862745098])
)
transform used: Compose(
    <data.transforms.CovertBGR object at 0x7ff4ae1d19b0>
    Resize(size=256, interpolation=PIL.Image.BILINEAR)
    CenterCrop(size=(227, 227))
    ToTensor()
    Normalize(mean=[0.40784313725490196, 0.4588235294117647, 0.5019607843137255], std=[0.00392156862745098, 0.00392156862745098, 0.00392156862745098])
)
Epoch: [001][6/6]	Time 2.998	Loss 1.0537 	Loss_rot 1.4082 	Loss_rot_test 0.0000 	accuracy 0.0062 	Pos 0.5206	Neg 0.4138 	
Epoch: [002][6/6]	Time 2.249	Loss 1.0451 	Loss_rot 1.3667 	Loss_rot_test 0.0000 	accuracy 0.0083 	Pos 0.5149	Neg 0.3959 	
Epoch: [003][6/6]	Time 1.801	Loss 1.0489 	Loss_rot 1.4063 	Loss_rot_test 0.0000 	accuracy 0.0000 	Pos 0.5756	Neg 0.3804 	
Epoch: [004][6/6]	Time 1.879	Loss 1.0400 	Loss_rot 1.3939 	Loss_rot_test 0.0000 	accuracy 0.0021 	Pos 0.5804	Neg 0.3665 	
Epoch: [005][6/6]	Time 2.046	Loss 1.0307 	Loss_rot 1.3664 	Loss_rot_test 0.0000 	accuracy 0.0000 	Pos 0.5591	Neg 0.3757 	
width: 	 227
bgr init
train.txt is used!
transform used: Compose(
    <data.transforms.CovertBGR object at 0x7ff4b601a198>
    Resize(size=256, interpolation=PIL.Image.BILINEAR)
    RandomResizedCrop(size=(227, 227), scale=(0.16, 1), ratio=(0.75, 1.3333), interpolation=PIL.Image.BILINEAR)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.40784313725490196, 0.4588235294117647, 0.5019607843137255], std=[0.00392156862745098, 0.00392156862745098, 0.00392156862745098])
)
transform used: Compose(
    <data.transforms.CovertBGR object at 0x7ff4b601a198>
    Resize(size=256, interpolation=PIL.Image.BILINEAR)
    CenterCrop(size=(227, 227))
    ToTensor()
    Normalize(mean=[0.40784313725490196, 0.4588235294117647, 0.5019607843137255], std=[0.00392156862745098, 0.00392156862745098, 0.00392156862745098])
)
Extract Features: [74/74]	Time 0.013 (0.013)	Data 50.064 (50.064)	
torch.Size([5864, 512]) <class 'torch.Tensor'>
finish cluster
label 0 100
0.20231513093423756 (100, 512)
width: 	 227
bgr init
train_1.txt is used!
transform used: Compose(
    <data.transforms.CovertBGR object at 0x7ff4addc4208>
    Resize(size=256, interpolation=PIL.Image.BILINEAR)
    RandomResizedCrop(size=(227, 227), scale=(0.16, 1), ratio=(0.75, 1.3333), interpolation=PIL.Image.BILINEAR)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.40784313725490196, 0.4588235294117647, 0.5019607843137255], std=[0.00392156862745098, 0.00392156862745098, 0.00392156862745098])
)
transform used: Compose(
    <data.transforms.CovertBGR object at 0x7ff4addc4208>
    Resize(size=256, interpolation=PIL.Image.BILINEAR)
    CenterCrop(size=(227, 227))
    ToTensor()
    Normalize(mean=[0.40784313725490196, 0.4588235294117647, 0.5019607843137255], std=[0.00392156862745098, 0.00392156862745098, 0.00392156862745098])
)
width: 	 227
bgr init
train.txt is used!
transform used: Compose(
    <data.transforms.CovertBGR object at 0x7ff5253fcd68>
    Resize(size=256, interpolation=PIL.Image.BILINEAR)
    RandomResizedCrop(size=(227, 227), scale=(0.16, 1), ratio=(0.75, 1.3333), interpolation=PIL.Image.BILINEAR)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.40784313725490196, 0.4588235294117647, 0.5019607843137255], std=[0.00392156862745098, 0.00392156862745098, 0.00392156862745098])
)
transform used: Compose(
    <data.transforms.CovertBGR object at 0x7ff5253fcd68>
    Resize(size=256, interpolation=PIL.Image.BILINEAR)
    CenterCrop(size=(227, 227))
    ToTensor()
    Normalize(mean=[0.40784313725490196, 0.4588235294117647, 0.5019607843137255], std=[0.00392156862745098, 0.00392156862745098, 0.00392156862745098])
)
Extract Features: [75/75]	Time 0.007 (0.007)	Data 52.904 (52.904)	
tensor(2281.9717) test
100 num_clusters
K-means done
[0.46674544 0.59469953 0.71033086 0.81634031 0.89618501 0.94902093] 0.5452069870079053
Epoch-0 0.4667  0.5947  0.7103  0.8163  0.8962  0.9490  0.5452
######################################## 
 BatchNorm frozen
Epoch: [006][6/6]	Time 2.706	Loss 1.0328 	Loss_rot 1.3787 	Loss_rot_test 0.0000 	accuracy 0.0021 	Pos 0.5118	Neg 0.3565 	
Epoch: [007][6/6]	Time 2.195	Loss 1.0273 	Loss_rot 1.3713 	Loss_rot_test 0.0000 	accuracy 0.0021 	Pos 0.5184	Neg 0.3814 	
Epoch: [008][6/6]	Time 2.254	Loss 1.0184 	Loss_rot 1.3795 	Loss_rot_test 0.0000 	accuracy 0.0021 	Pos 0.5543	Neg 0.3364 	
Epoch: [009][6/6]	Time 2.369	Loss 1.0224 	Loss_rot 1.3874 	Loss_rot_test 0.0000 	accuracy 0.0000 	Pos 0.4996	Neg 0.3805 	
Epoch: [010][6/6]	Time 2.263	Loss 1.0137 	Loss_rot 1.3938 	Loss_rot_test 0.0000 	accuracy 0.0146 	Pos 0.5110	Neg 0.3702 	
width: 	 227
bgr init
train.txt is used!
transform used: Compose(
    <data.transforms.CovertBGR object at 0x7ff5253fcd68>
    Resize(size=256, interpolation=PIL.Image.BILINEAR)
    RandomResizedCrop(size=(227, 227), scale=(0.16, 1), ratio=(0.75, 1.3333), interpolation=PIL.Image.BILINEAR)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.40784313725490196, 0.4588235294117647, 0.5019607843137255], std=[0.00392156862745098, 0.00392156862745098, 0.00392156862745098])
)
transform used: Compose(
    <data.transforms.CovertBGR object at 0x7ff5253fcd68>
    Resize(size=256, interpolation=PIL.Image.BILINEAR)
    CenterCrop(size=(227, 227))
    ToTensor()
    Normalize(mean=[0.40784313725490196, 0.4588235294117647, 0.5019607843137255], std=[0.00392156862745098, 0.00392156862745098, 0.00392156862745098])
)
Extract Features: [74/74]	Time 0.013 (0.013)	Data 51.813 (51.813)	
torch.Size([5864, 512]) <class 'torch.Tensor'>
/users/xcao1/anaconda/my_env_1.2/lib/python3.6/site-packages/sklearn/cluster/k_means_.py:896: RuntimeWarning: Explicit initial center position passed: performing only one init in k-means instead of n_init=10
  return_n_iter=True)
finish cluster
label 0 100
0.21551784515584746 (100, 512)
width: 	 227
bgr init
train_1.txt is used!
transform used: Compose(
    <data.transforms.CovertBGR object at 0x7ff4ae1e8550>
    Resize(size=256, interpolation=PIL.Image.BILINEAR)
    RandomResizedCrop(size=(227, 227), scale=(0.16, 1), ratio=(0.75, 1.3333), interpolation=PIL.Image.BILINEAR)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.40784313725490196, 0.4588235294117647, 0.5019607843137255], std=[0.00392156862745098, 0.00392156862745098, 0.00392156862745098])
)
transform used: Compose(
    <data.transforms.CovertBGR object at 0x7ff4ae1e8550>
    Resize(size=256, interpolation=PIL.Image.BILINEAR)
    CenterCrop(size=(227, 227))
    ToTensor()
    Normalize(mean=[0.40784313725490196, 0.4588235294117647, 0.5019607843137255], std=[0.00392156862745098, 0.00392156862745098, 0.00392156862745098])
)
width: 	 227
bgr init
train.txt is used!
transform used: Compose(
    <data.transforms.CovertBGR object at 0x7ff4ae1e8710>
    Resize(size=256, interpolation=PIL.Image.BILINEAR)
    RandomResizedCrop(size=(227, 227), scale=(0.16, 1), ratio=(0.75, 1.3333), interpolation=PIL.Image.BILINEAR)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.40784313725490196, 0.4588235294117647, 0.5019607843137255], std=[0.00392156862745098, 0.00392156862745098, 0.00392156862745098])
)
transform used: Compose(
    <data.transforms.CovertBGR object at 0x7ff4ae1e8710>
    Resize(size=256, interpolation=PIL.Image.BILINEAR)
    CenterCrop(size=(227, 227))
    ToTensor()
    Normalize(mean=[0.40784313725490196, 0.4588235294117647, 0.5019607843137255], std=[0.00392156862745098, 0.00392156862745098, 0.00392156862745098])
)
Extract Features: [75/75]	Time 0.005 (0.005)	Data 62.399 (62.399)	
tensor(3340.9841) test
100 num_clusters
K-means done
[0.47248481 0.59436192 0.71353815 0.81920999 0.89601621 0.95205942] 0.5477529183886766
Epoch-0 0.4725  0.5944  0.7135  0.8192  0.8960  0.9521  0.5478
######################################## 
 BatchNorm frozen
Epoch: [011][6/6]	Time 2.629	Loss 1.0155 	Loss_rot 1.3705 	Loss_rot_test 0.0000 	accuracy 0.0021 	Pos 0.4843	Neg 0.3478 	
Epoch: [012][6/6]	Time 2.464	Loss 1.0027 	Loss_rot 1.3724 	Loss_rot_test 0.0000 	accuracy 0.0062 	Pos 0.4960	Neg 0.3613 	
Epoch: [013][6/6]	Time 2.598	Loss 1.0091 	Loss_rot 1.3936 	Loss_rot_test 0.0000 	accuracy 0.0042 	Pos 0.4977	Neg 0.3499 	
Epoch: [014][6/6]	Time 2.337	Loss 0.9883 	Loss_rot 1.3659 	Loss_rot_test 0.0000 	accuracy 0.0104 	Pos 0.5315	Neg 0.3502 	
Epoch: [015][6/6]	Time 2.622	Loss 1.0119 	Loss_rot 1.3505 	Loss_rot_test 0.0000 	accuracy 0.0021 	Pos 0.5336	Neg 0.3586 	
width: 	 227
bgr init
train.txt is used!
transform used: Compose(
    <data.transforms.CovertBGR object at 0x7ff4cedf1898>
    Resize(size=256, interpolation=PIL.Image.BILINEAR)
    RandomResizedCrop(size=(227, 227), scale=(0.16, 1), ratio=(0.75, 1.3333), interpolation=PIL.Image.BILINEAR)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.40784313725490196, 0.4588235294117647, 0.5019607843137255], std=[0.00392156862745098, 0.00392156862745098, 0.00392156862745098])
)
transform used: Compose(
    <data.transforms.CovertBGR object at 0x7ff4cedf1898>
    Resize(size=256, interpolation=PIL.Image.BILINEAR)
    CenterCrop(size=(227, 227))
    ToTensor()
    Normalize(mean=[0.40784313725490196, 0.4588235294117647, 0.5019607843137255], std=[0.00392156862745098, 0.00392156862745098, 0.00392156862745098])
)
Extract Features: [74/74]	Time 0.012 (0.012)	Data 56.601 (56.601)	
torch.Size([5864, 512]) <class 'torch.Tensor'>
finish cluster
label 0 100
0.22091342710800307 (100, 512)
width: 	 227
bgr init
train_1.txt is used!
transform used: Compose(
    <data.transforms.CovertBGR object at 0x7ff4ade76c50>
    Resize(size=256, interpolation=PIL.Image.BILINEAR)
    RandomResizedCrop(size=(227, 227), scale=(0.16, 1), ratio=(0.75, 1.3333), interpolation=PIL.Image.BILINEAR)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.40784313725490196, 0.4588235294117647, 0.5019607843137255], std=[0.00392156862745098, 0.00392156862745098, 0.00392156862745098])
)
transform used: Compose(
    <data.transforms.CovertBGR object at 0x7ff4ade76c50>
    Resize(size=256, interpolation=PIL.Image.BILINEAR)
    CenterCrop(size=(227, 227))
    ToTensor()
    Normalize(mean=[0.40784313725490196, 0.4588235294117647, 0.5019607843137255], std=[0.00392156862745098, 0.00392156862745098, 0.00392156862745098])
)
width: 	 227
bgr init
train.txt is used!
transform used: Compose(
    <data.transforms.CovertBGR object at 0x7ff4ade76208>
    Resize(size=256, interpolation=PIL.Image.BILINEAR)
    RandomResizedCrop(size=(227, 227), scale=(0.16, 1), ratio=(0.75, 1.3333), interpolation=PIL.Image.BILINEAR)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.40784313725490196, 0.4588235294117647, 0.5019607843137255], std=[0.00392156862745098, 0.00392156862745098, 0.00392156862745098])
)
transform used: Compose(
    <data.transforms.CovertBGR object at 0x7ff4ade76208>
    Resize(size=256, interpolation=PIL.Image.BILINEAR)
    CenterCrop(size=(227, 227))
    ToTensor()
    Normalize(mean=[0.40784313725490196, 0.4588235294117647, 0.5019607843137255], std=[0.00392156862745098, 0.00392156862745098, 0.00392156862745098])
)
Extract Features: [75/75]	Time 0.005 (0.005)	Data 64.732 (64.732)	
tensor(3710.5007) test
100 num_clusters
K-means done
[0.46944632 0.59554355 0.71218771 0.8158339  0.90192438 0.94969615] 0.5599007882639404
Epoch-0 0.4694  0.5955  0.7122  0.8158  0.9019  0.9497  0.5599
######################################## 
 BatchNorm frozen
Epoch: [016][6/6]	Time 3.217	Loss 1.0048 	Loss_rot 1.3622 	Loss_rot_test 0.0000 	accuracy 0.0042 	Pos 0.5022	Neg 0.3662 	
Epoch: [017][6/6]	Time 2.834	Loss 1.0011 	Loss_rot 1.3468 	Loss_rot_test 0.0000 	accuracy 0.0125 	Pos 0.5151	Neg 0.3503 	
Epoch: [018][6/6]	Time 3.032	Loss 1.0162 	Loss_rot 1.3296 	Loss_rot_test 0.0000 	accuracy 0.0021 	Pos 0.5509	Neg 0.3317 	
Epoch: [019][6/6]	Time 2.667	Loss 1.0066 	Loss_rot 1.3406 	Loss_rot_test 0.0000 	accuracy 0.0000 	Pos 0.5575	Neg 0.3436 	
Epoch: [020][6/6]	Time 2.766	Loss 0.9817 	Loss_rot 1.2988 	Loss_rot_test 0.0000 	accuracy 0.0063 	Pos 0.5307	Neg 0.3450 	
width: 	 227
bgr init
train.txt is used!
transform used: Compose(
    <data.transforms.CovertBGR object at 0x7ff4cedf1be0>
    Resize(size=256, interpolation=PIL.Image.BILINEAR)
    RandomResizedCrop(size=(227, 227), scale=(0.16, 1), ratio=(0.75, 1.3333), interpolation=PIL.Image.BILINEAR)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.40784313725490196, 0.4588235294117647, 0.5019607843137255], std=[0.00392156862745098, 0.00392156862745098, 0.00392156862745098])
)
transform used: Compose(
    <data.transforms.CovertBGR object at 0x7ff4cedf1be0>
    Resize(size=256, interpolation=PIL.Image.BILINEAR)
    CenterCrop(size=(227, 227))
    ToTensor()
    Normalize(mean=[0.40784313725490196, 0.4588235294117647, 0.5019607843137255], std=[0.00392156862745098, 0.00392156862745098, 0.00392156862745098])
)
Extract Features: [74/74]	Time 0.013 (0.013)	Data 55.527 (55.527)	
torch.Size([5864, 512]) <class 'torch.Tensor'>
finish cluster
label 0 100
0.22410521336120176 (100, 512)
width: 	 227
bgr init
train_1.txt is used!
transform used: Compose(
    <data.transforms.CovertBGR object at 0x7ff4b601a390>
    Resize(size=256, interpolation=PIL.Image.BILINEAR)
    RandomResizedCrop(size=(227, 227), scale=(0.16, 1), ratio=(0.75, 1.3333), interpolation=PIL.Image.BILINEAR)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.40784313725490196, 0.4588235294117647, 0.5019607843137255], std=[0.00392156862745098, 0.00392156862745098, 0.00392156862745098])
)
transform used: Compose(
    <data.transforms.CovertBGR object at 0x7ff4b601a390>
    Resize(size=256, interpolation=PIL.Image.BILINEAR)
    CenterCrop(size=(227, 227))
    ToTensor()
    Normalize(mean=[0.40784313725490196, 0.4588235294117647, 0.5019607843137255], std=[0.00392156862745098, 0.00392156862745098, 0.00392156862745098])
)
width: 	 227
bgr init
train.txt is used!
transform used: Compose(
    <data.transforms.CovertBGR object at 0x7ff4addc49e8>
    Resize(size=256, interpolation=PIL.Image.BILINEAR)
    RandomResizedCrop(size=(227, 227), scale=(0.16, 1), ratio=(0.75, 1.3333), interpolation=PIL.Image.BILINEAR)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.40784313725490196, 0.4588235294117647, 0.5019607843137255], std=[0.00392156862745098, 0.00392156862745098, 0.00392156862745098])
)
transform used: Compose(
    <data.transforms.CovertBGR object at 0x7ff4addc49e8>
    Resize(size=256, interpolation=PIL.Image.BILINEAR)
    CenterCrop(size=(227, 227))
    ToTensor()
    Normalize(mean=[0.40784313725490196, 0.4588235294117647, 0.5019607843137255], std=[0.00392156862745098, 0.00392156862745098, 0.00392156862745098])
)
Extract Features: [75/75]	Time 0.005 (0.005)	Data 64.639 (64.639)	
tensor(4119.2104) test
100 num_clusters
K-means done
[0.47197839 0.59436192 0.71421337 0.81515868 0.8993923  0.9512154 ] 0.5532707655741209
Epoch-0 0.4720  0.5944  0.7142  0.8152  0.8994  0.9512  0.5533
######################################## 
 BatchNorm frozen
Epoch: [021][6/6]	Time 2.815	Loss 1.0028 	Loss_rot 1.3351 	Loss_rot_test 0.0000 	accuracy 0.0042 	Pos 0.5030	Neg 0.3579 	
Epoch: [022][6/6]	Time 2.741	Loss 0.9881 	Loss_rot 1.3261 	Loss_rot_test 0.0000 	accuracy 0.0063 	Pos 0.5666	Neg 0.3553 	
Epoch: [023][6/6]	Time 3.312	Loss 0.9978 	Loss_rot 1.3017 	Loss_rot_test 0.0000 	accuracy 0.0063 	Pos 0.4948	Neg 0.3605 	
Epoch: [024][6/6]	Time 2.545	Loss 0.9896 	Loss_rot 1.2886 	Loss_rot_test 0.0000 	accuracy 0.0167 	Pos 0.5110	Neg 0.3556 	
Epoch: [025][6/6]	Time 2.890	Loss 0.9960 	Loss_rot 1.2928 	Loss_rot_test 0.0000 	accuracy 0.0083 	Pos 0.5578	Neg 0.3407 	
width: 	 227
bgr init
train.txt is used!
transform used: Compose(
    <data.transforms.CovertBGR object at 0x7ff4b601a0f0>
    Resize(size=256, interpolation=PIL.Image.BILINEAR)
    RandomResizedCrop(size=(227, 227), scale=(0.16, 1), ratio=(0.75, 1.3333), interpolation=PIL.Image.BILINEAR)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=[0.40784313725490196, 0.4588235294117647, 0.5019607843137255], std=[0.00392156862745098, 0.00392156862745098, 0.00392156862745098])
)
transform used: Compose(
    <data.transforms.CovertBGR object at 0x7ff4b601a0f0>
    Resize(size=256, interpolation=PIL.Image.BILINEAR)
    CenterCrop(size=(227, 227))
    ToTensor()
    Normalize(mean=[0.40784313725490196, 0.4588235294117647, 0.5019607843137255], std=[0.00392156862745098, 0.00392156862745098, 0.00392156862745098])
)
Extract Features: [74/74]	Time 0.012 (0.012)	Data 65.908 (65.908)	
torch.Size([5864, 512]) <class 'torch.Tensor'>
